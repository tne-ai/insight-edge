import pandas as pd
from tne.TNE import TNE

# Initialize TNE session
session = TNE(uid=UID, bucket_name=BUCKET, project=PROJECT, version=VERSION)

# Load data from CSV file
df = session.get_object("handbags-shopping_list-no_run-1_1-with_periods_cleaned.csv")

# Filter data for 'newness' range segment
newness_df = df[df['range_segment'] == 'Newness']

# Group by 'period' (month) and calculate total sales for each month
monthly_sales_newness = newness_df.groupby('period')['sales'].sum().reset_index()

# Rename columns for clarity
monthly_sales_newness.columns = ['Month (YYYYMM)', 'Monthly Sales for Newness']

# Limit to 12 rows if more than 12 months are present
result = monthly_sales_newness.head(12)

print(result)