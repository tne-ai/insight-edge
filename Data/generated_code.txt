import pandas as pd
from tne.TNE import TNE

# Initialize session and get data
session = TNE(uid=UID, bucket_name=BUCKET, project=PROJECT, version=VERSION)
df = session.get_object("womens_rtw-shopping_list-442-1_1-with_periods-with_sizes_cleaned.csv")

# Filter for tops
tops_df = df[df['product_hier_feature_1_desc'] == 'WOMENS TOPS']

# Group by size_code and colour_description, then sum sales
grouped_df = tops_df.groupby(['size_code', 'colour_description'])['sales'].sum().reset_index()

# Find the most popular color for each size
result = grouped_df.loc[grouped_df.groupby('size_code')['sales'].idxmax()].sort_values(by='size_code').head(12)