from tne.TNE import TNE
import pandas as pd

session = TNE(uid=UID, bucket_name=BUCKET, project=PROJECT, version=VERSION)
df = session.get_object("handbags-shopping_list-no_run-1_1-with_periods_cleaned.csv")

# Filter data for November
november_df = df[df['month'] == 'November']

# Group by product_subgroup_desc and find the best selling style_colour_desc in each subcategory
best_selling_df = november_df.groupby('product_subgroup_desc').apply(
    lambda x: x.loc[x['sales'].idxmax()]
).reset_index(drop=True)

# Select the required columns
result = best_selling_df[['product_subgroup_desc', 'style_colour_desc', 'sales']]