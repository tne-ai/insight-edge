import pandas as pd
from tne.TNE import TNE

# Initialize TNE session
session = TNE(uid=UID, bucket_name=BUCKET, project=PROJECT, version=VERSION)

# Load data
df = session.get_object("handbags-shopping_list-no_run-1_1-with_periods_cleaned.csv")

# Filter data for December
december_df = df[df['month'] == 'December']

# Group by product_subgroup_desc and sum sales
top_subclasses = december_df.groupby('product_subgroup_desc')['sales'].sum().reset_index()

# Sort in descending order by sales and limit to top 12
top_subclasses = top_subclasses.sort_values(by='sales', ascending=False).head(12)

# Rename columns for clarity
top_subclasses = top_subclasses.rename(columns={'product_subgroup_desc': 'Top Subclasses', 'sales': 'Total Sales in December'})

# Store result in 'result' variable
result = top_subclasses