import pandas as pd
from tne.TNE import TNE

# Initialize session and get data
session = TNE(uid=UID, bucket_name=BUCKET, project=PROJECT, version=VERSION)
df = session.get_object("womens_rtw-shopping_list-442-1_1-with_periods-with_sizes_cleaned.csv")

# Filter for 'Newness' range_segment
newness_df = df[df['range_segment'] == 'Newness']

# Group by 'material' and 'colour_description', then sum the sales
grouped_sales = newness_df.groupby(['material', 'colour_description'])['sales'].sum().reset_index()

# Sort by sales in descending order to find the best-selling combination
best_selling_combination = grouped_sales.sort_values(by='sales', ascending=False).head(1)

# Limit the result to the first 12 items if necessary
result = best_selling_combination.head(12)