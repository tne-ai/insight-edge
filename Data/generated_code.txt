import pandas as pd
from tne.TNE import TNE

# Initialize TNE session
session = TNE(uid=UID, bucket_name=BUCKET, project=PROJECT, version=VERSION)

# Load data
df = session.get_object("handbags-shopping_list-no_run-1_1-with_periods_cleaned.csv")

# Filter data for 'Newness' range segment
newness_df = df[df['range_segment'] == 'Newness']

# Group by 'month' and sum 'sales' to find total sales for each month
monthly_sales = newness_df.groupby('month')['sales'].sum().reset_index()

# Sort by 'sales' in descending order to find the best month
best_month = monthly_sales.sort_values(by='sales', ascending=False).head(1)

# Create result DataFrame with the best month and its corresponding sales
result = pd.DataFrame({
    'Best Month for Newness': [best_month['month'].values[0]],
    'Total Sales': [best_month['sales'].values[0]]
})

print(result)