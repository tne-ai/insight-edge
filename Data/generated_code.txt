import pandas as pd
from tne.TNE import TNE

# Initialize session and get data
session = TNE(uid=UID, bucket_name=BUCKET, project=PROJECT, version=VERSION)
df = session.get_object("womens_rtw-shopping_list-442-1_1-with_periods-with_sizes_cleaned.csv")

# Filter for pareto A and range_segment Newness
filtered_df = df[(df['pareto'] == 'A') & (df['range_segment'] == 'Newness')]

# Group by material and colour_description and calculate total sales
result = filtered_df.groupby(['material', 'colour_description'])['sales'].sum().reset_index().head(12)