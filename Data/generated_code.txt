import pandas as pd
from tne.TNE import TNE

# Initialize session and get data
session = TNE(uid=UID, bucket_name=BUCKET, project=PROJECT, version=VERSION)
df = session.get_object("handbags-shopping_list-no_run-1_1-with_periods_cleaned.csv")

# Filter for products with pareto designation 'A*' or 'A'
star_products = df[df['pareto'].isin(['A', 'A*'])]

# Group by season and count the number of unique style_colour_desc for each season
result = star_products.groupby('season')['style_colour_desc'].nunique().reset_index()
result.columns = ['season', 'star_product_count']