import pandas as pd
from tne.TNE import TNE

# Initialize TNE session
session = TNE(uid=UID, bucket_name=BUCKET, project=PROJECT, version=VERSION)

# Load data from CSV file
df = session.get_object("handbags-shopping_list-no_run-1_1-with_periods_cleaned.csv")

# Filter data for Crossbody bag
crossbody_bag_df = df[df['product_subgroup_desc'] == 'Crossbody bag']

# Calculate total sales for each style-color
total_sales_df = crossbody_bag_df.groupby('style_colour_desc')['sales'].sum().reset_index()
total_sales_df = total_sales_df.rename(columns={'sales': 'total_sales'})

# Sort by total sales in descending order and select top 5
top_5_total_sales_df = total_sales_df.sort_values(by='total_sales', ascending=False).head(5)

# Store result in 'result' variable
result = top_5_total_sales_df[['style_colour_desc', 'total_sales']]