import pandas as pd
from tne.TNE import TNE

# Initialize TNE session
session = TNE(uid=UID, bucket_name=BUCKET, project=PROJECT, version=VERSION)

# Load data
df = session.get_object("handbags-shopping_list-no_run-1_1-with_periods_cleaned.csv")

# Filter data for totes
totes_df = df[df['product_subgroup_desc'] == 'Tote bag']

# Calculate total sales units for totes and all products
total_tote_sales_units = totes_df['sales'].sum()
total_all_sales_units = df['sales'].sum()

# Calculate unit contribution of totes
unit_contribution_totes = (total_tote_sales_units / total_all_sales_units) * 100

# Calculate revenue (sales value) for totes and all products
totes_revenue = (totes_df['aur'] * totes_df['sales']).sum()
all_revenue = (df['aur'] * df['sales']).sum()

# Calculate revenue contribution of totes
revenue_contribution_totes = (totes_revenue / all_revenue) * 100

# Create result DataFrame
result = pd.DataFrame({
    'Contribution Type': ['Unit Contribution', 'Revenue Contribution'],
    'Totes Contribution': [unit_contribution_totes, revenue_contribution_totes]
})

# Limit to 12 rows (not applicable in this case, but added for consistency)
result = result.head(12)

# Store final result
result = result