import pandas as pd
from tne.TNE import TNE

# Initialize session and get data
session = TNE(uid=UID, bucket_name=BUCKET, project=PROJECT, version=VERSION)
df = session.get_object("womens_rtw-shopping_list-442-1_1-with_periods-with_sizes_cleaned.csv")

# Filter data for 'WOMENS PANTS'
womens_pants_df = df[df['product_subgroup_desc'] == 'WOMENS PANTS']

# Group by 'period' and sum 'sales'
monthly_sales = womens_pants_df.groupby('period')['sales'].sum().reset_index()

# Find the month with the highest sales
best_month = monthly_sales.loc[monthly_sales['sales'].idxmax()]

# Convert period to a readable format
best_month['period'] = pd.to_datetime(best_month['period'], format='%Y%m').strftime('%B %Y')

# Prepare the result
result = pd.DataFrame([best_month])