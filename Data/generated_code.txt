import pandas as pd
from tne.TNE import TNE

# Initialize session and get data
session = TNE(uid=UID, bucket_name=BUCKET, project=PROJECT, version=VERSION)
df = session.get_object("womens_rtw-shopping_list-442-1_1-with_periods-with_sizes_cleaned.csv")

# Filter for Newness products with Polyester Blend material
filtered_df = df[(df['range_segment'] == 'Newness') & (df['material'] == 'Polyester Blend')]

# Group by color description and sum sales to get total sales per color
total_sales_per_color = filtered_df.groupby('colour_description')['sales'].sum().reset_index()

# Sort by total sales in descending order and limit to 12 items
result = total_sales_per_color.sort_values(by='sales', ascending=False).head(12)