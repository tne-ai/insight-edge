import pandas as pd
from tne.TNE import TNE

# Initialize session and get data
session = TNE(uid=UID, bucket_name=BUCKET, project=PROJECT, version=VERSION)
df = session.get_object("womens_rtw-shopping_list-442-1_1-with_periods-with_sizes_cleaned.csv")

# Calculate total sales by subgroup
sales_by_subgroup = df.groupby('product_subgroup_desc')['sales'].sum()

# Count unique styles by subgroup
styles_by_subgroup = df.groupby('product_subgroup_desc')['style_color_description'].nunique()

# Combine into final dataframe
result = pd.DataFrame({
    'Total Sales': sales_by_subgroup,
    'Number of Styles': styles_by_subgroup
}).reset_index()

# Sort by total sales descending
result = result.sort_values('Total Sales', ascending=False)