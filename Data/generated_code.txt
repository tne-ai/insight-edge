from tne.TNE import TNE
import pandas as pd

session = TNE(uid=UID, bucket_name=BUCKET, project=PROJECT, version=VERSION)
df = session.get_object("handbags-shopping_list-no_run-1_1-with_periods_cleaned.csv")

# Filter for crossbody bags
crossbody_bags = df[df['product_subgroup_desc'] == 'Crossbody bag']

# Group by style_colour_desc and calculate the average margin percentage
crossbody_bags_margin = crossbody_bags.groupby('style_colour_desc')['margin %'].mean().reset_index()

# Sort by margin percentage in descending order
crossbody_bags_margin_sorted = crossbody_bags_margin.sort_values(by='margin %', ascending=False)

# Select the top 12 items
result = crossbody_bags_margin_sorted.head(12)