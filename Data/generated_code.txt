import pandas as pd
from tne.TNE import TNE

# Initialize session and get data
session = TNE(uid=UID, bucket_name=BUCKET, project=PROJECT, version=VERSION)
df = session.get_object("womens_rtw-shopping_list-442-1_1-with_periods-with_sizes_cleaned.csv")

# Filter for Women Pants in November
df_november_pants = df[(df['product_subgroup_desc'] == 'WOMENS PANTS') & (df['period'] == 202111)]

# Group by size_code and sum sales
size_sales = df_november_pants.groupby('size_code')['sales'].sum().reset_index()

# Sort by sales in descending order and get the top 12 sizes
top_sizes = size_sales.sort_values(by='sales', ascending=False).head(12)

# Assign the result
result = top_sizes