import pandas as pd
from tne.TNE import TNE

# Initialize session and get data
session = TNE(uid=UID, bucket_name=BUCKET, project=PROJECT, version=VERSION)
df = session.get_object("womens_rtw-shopping_list-442-1_1-with_periods-with_sizes_cleaned.csv")

# Filter for Women Shorts and products launched in February
df['product_launch_date'] = pd.to_datetime(df['product_launch_date'], format='%d/%m/%Y')
df_february_launch = df[(df['product_subgroup_desc'] == 'WOMENS SHORTS') & (df['product_launch_date'].dt.month == 2)]

# Group by SKU and sum sales
df_sku_sales = df_february_launch.groupby('sku_id')['sales'].sum().reset_index()

# Sort by sales in descending order and get top 10 SKUs
df_top_skus = df_sku_sales.sort_values(by='sales', ascending=False).head(10)

result = df_top_skus